<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4. WLAN step by step &mdash; MicroPython 1.16 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/customstyle.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5. Hardware timers" href="timer.html" />
    <link rel="prev" title="3. Getting started with Blynk and the WiPy" href="blynk.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> MicroPython
          </a>
              <div class="version">
                1.16
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../library/index.html">MicroPython libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">MicroPython language and implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../genrst/index.html">MicroPython differences from CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../develop/index.html">MicroPython Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">MicroPython license information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pyboard/quickref.html">Quick reference for the pyboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../esp8266/quickref.html">Quick reference for the ESP8266</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../esp32/quickref.html">Quick reference for the ESP32</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rp2/quickref.html">Quick reference for the RP2</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../quickref.html">Quick reference for the WiPy</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../general.html">General information about the WiPy</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">WiPy tutorials and examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="intro.html">1. Introduction to the WiPy</a></li>
<li class="toctree-l3"><a class="reference internal" href="repl.html">2. Getting a MicroPython REPL prompt</a></li>
<li class="toctree-l3"><a class="reference internal" href="blynk.html">3. Getting started with Blynk and the WiPy</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">4. WLAN step by step</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#connecting-to-your-home-router">4.1. Connecting to your home router</a></li>
<li class="toctree-l4"><a class="reference internal" href="#assigning-a-static-ip-address-when-booting">4.2. Assigning a static IP address when booting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="timer.html">5. Hardware timers</a></li>
<li class="toctree-l3"><a class="reference internal" href="reset.html">6. Reset and boot modes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../quickref.html#general-board-control-including-sleep-modes">General board control (including sleep modes)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickref.html#pins-and-gpio">Pins and GPIO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickref.html#timers">Timers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickref.html#pwm-pulse-width-modulation">PWM (pulse width modulation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickref.html#adc-analog-to-digital-conversion">ADC (analog to digital conversion)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickref.html#uart-serial-bus">UART (serial bus)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickref.html#spi-bus">SPI bus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickref.html#i2c-bus">I2C bus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickref.html#watchdog-timer-wdt">Watchdog timer (WDT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickref.html#real-time-clock-rtc">Real time clock (RTC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickref.html#sd-card">SD card</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickref.html#wlan-wifi">WLAN (WiFi)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickref.html#telnet-and-ftp-server">Telnet and FTP server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickref.html#heart-beat-led">Heart beat LED</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/quickref.html">Quick reference for the UNIX and Windows ports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../zephyr/quickref.html">Quick reference for the Zephyr port</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MicroPython</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../quickref.html">Quick reference for the WiPy</a> &raquo;</li>
          <li><a href="index.html">WiPy tutorials and examples</a> &raquo;</li>
      <li><span class="section-number">4. </span>WLAN step by step</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/wipy/tutorial/wlan.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="wlan-step-by-step">
<h1><span class="section-number">4. </span>WLAN step by step<a class="headerlink" href="#wlan-step-by-step" title="Permalink to this headline">¶</a></h1>
<p>The WLAN is a system feature of the WiPy, therefore it is always enabled
(even while in <code class="docutils literal notranslate"><span class="pre">machine.SLEEP</span></code>), except when deepsleep mode is entered.</p>
<p>In order to retrieve the current WLAN instance, do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">network</span> <span class="kn">import</span> <span class="n">WLAN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wlan</span> <span class="o">=</span> <span class="n">WLAN</span><span class="p">()</span> <span class="c1"># we call the constructor without params</span>
</pre></div>
</div>
<p>You can check the current mode (which is always <code class="docutils literal notranslate"><span class="pre">WLAN.AP</span></code> after power up):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wlan</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When you change the WLAN mode following the instructions below, your WLAN
connection to the WiPy will be broken. This means you will not be able
to run these commands interactively over the WLAN.</p>
<dl class="simple">
<dt>There are two ways around this::</dt><dd><ol class="arabic simple">
<li><p>put this setup code into your <a class="reference internal" href="../general.html#wipy-filesystem"><span class="std std-ref">boot.py file</span></a> so that it gets executed automatically after reset.</p></li>
<li><p><a class="reference internal" href="repl.html#wipy-uart"><span class="std std-ref">duplicate the REPL on UART</span></a>, so that you can run commands via USB.</p></li>
</ol>
</dd>
</dl>
</div>
<section id="connecting-to-your-home-router">
<h2><span class="section-number">4.1. </span>Connecting to your home router<a class="headerlink" href="#connecting-to-your-home-router" title="Permalink to this headline">¶</a></h2>
<p>The WLAN network card always boots in <code class="docutils literal notranslate"><span class="pre">WLAN.AP</span></code> mode, so we must first configure
it as a station:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">network</span> <span class="kn">import</span> <span class="n">WLAN</span>
<span class="n">wlan</span> <span class="o">=</span> <span class="n">WLAN</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">WLAN</span><span class="o">.</span><span class="n">STA</span><span class="p">)</span>
</pre></div>
</div>
<p>Now you can proceed to scan for networks:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nets</span> <span class="o">=</span> <span class="n">wlan</span><span class="o">.</span><span class="n">scan</span><span class="p">()</span>
<span class="k">for</span> <span class="n">net</span> <span class="ow">in</span> <span class="n">nets</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">net</span><span class="o">.</span><span class="n">ssid</span> <span class="o">==</span> <span class="s1">&#39;mywifi&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Network found!&#39;</span><span class="p">)</span>
        <span class="n">wlan</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">ssid</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">sec</span><span class="p">,</span> <span class="s1">&#39;mywifikey&#39;</span><span class="p">),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">wlan</span><span class="o">.</span><span class="n">isconnected</span><span class="p">():</span>
            <span class="n">machine</span><span class="o">.</span><span class="n">idle</span><span class="p">()</span> <span class="c1"># save power while waiting</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WLAN connection succeeded!&#39;</span><span class="p">)</span>
        <span class="k">break</span>
</pre></div>
</div>
</section>
<section id="assigning-a-static-ip-address-when-booting">
<h2><span class="section-number">4.2. </span>Assigning a static IP address when booting<a class="headerlink" href="#assigning-a-static-ip-address-when-booting" title="Permalink to this headline">¶</a></h2>
<p>If you want your WiPy to connect to your home router after boot-up, and with a fixed
IP address so that you can access it via telnet or FTP, use the following script as /flash/boot.py:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">machine</span>
<span class="kn">from</span> <span class="nn">network</span> <span class="kn">import</span> <span class="n">WLAN</span>
<span class="n">wlan</span> <span class="o">=</span> <span class="n">WLAN</span><span class="p">()</span> <span class="c1"># get current object, without changing the mode</span>

<span class="k">if</span> <span class="n">machine</span><span class="o">.</span><span class="n">reset_cause</span><span class="p">()</span> <span class="o">!=</span> <span class="n">machine</span><span class="o">.</span><span class="n">SOFT_RESET</span><span class="p">:</span>
    <span class="n">wlan</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">WLAN</span><span class="o">.</span><span class="n">STA</span><span class="p">)</span>
    <span class="c1"># configuration below MUST match your home router settings!!</span>
    <span class="n">wlan</span><span class="o">.</span><span class="n">ifconfig</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;192.168.178.107&#39;</span><span class="p">,</span> <span class="s1">&#39;255.255.255.0&#39;</span><span class="p">,</span> <span class="s1">&#39;192.168.178.1&#39;</span><span class="p">,</span> <span class="s1">&#39;8.8.8.8&#39;</span><span class="p">))</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">wlan</span><span class="o">.</span><span class="n">isconnected</span><span class="p">():</span>
    <span class="c1"># change the line below to match your network ssid, security and password</span>
    <span class="n">wlan</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;mywifi&#39;</span><span class="p">,</span> <span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="n">WLAN</span><span class="o">.</span><span class="n">WPA2</span><span class="p">,</span> <span class="s1">&#39;mywifikey&#39;</span><span class="p">),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">wlan</span><span class="o">.</span><span class="n">isconnected</span><span class="p">():</span>
        <span class="n">machine</span><span class="o">.</span><span class="n">idle</span><span class="p">()</span> <span class="c1"># save power while waiting</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notice how we check for the reset cause and the connection status, this is crucial in order
to be able to soft reset the WiPy during a telnet session without breaking the connection.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="blynk.html" class="btn btn-neutral float-left" title="3. Getting started with Blynk and the WiPy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="timer.html" class="btn btn-neutral float-right" title="5. Hardware timers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright - The MicroPython Documentation is Copyright © 2014-2021, Damien P. George, Paul Sokolovsky, and contributors.
      <span class="lastupdated">Last updated on 08 Nov 2021.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Versions and Downloads</span>
    latest
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Versions</dt>
      
        <dd><a href="//en/latest">latest</a></dd>
      
    </dl>
    <dl>
      <dt>Downloads</dt>
      
        <dd><a href="//en/latest/micropython-docs.pdf">PDF</a></dd>
      
    </dl>
    <hr/>
    <dl>
      <dt>External links</dt>
        <dd>
          <a href="https://www.micropython.org">micropython.org</a>
        </dd>
        <dd>
          <a href="https://github.com/micropython/micropython">GitHub</a>
        </dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>